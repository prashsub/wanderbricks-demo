version: "1.1"
comment: >
  Host performance and quality analytics for vacation rental platform.
  Optimized for Genie natural language queries and AI/BI dashboards.
  Provides host portfolio metrics, verification status, ratings, property counts,
  and revenue performance for partner management and quality assurance.

source: ${catalog}.${gold_schema}.dim_host

joins:
  - name: fact_booking
    source: ${catalog}.${gold_schema}.fact_booking_detail
    'on': source.host_id = fact_booking.host_id
  
  - name: dim_property
    source: ${catalog}.${gold_schema}.dim_property
    'on': source.host_id = dim_property.host_id AND dim_property.is_current = true

dimensions:
  - name: host_id
    expr: source.host_id
    comment: Unique host identifier for host-level performance analysis
    display_name: Host ID
    synonyms:
      - host
      - host number
      - owner id
  
  - name: host_name
    expr: source.name
    comment: Host name for user-friendly identification in reports and dashboards
    display_name: Host Name
    synonyms:
      - host
      - owner
      - host owner
      - name
  
  - name: is_verified
    expr: source.is_verified
    comment: Host verification status indicating trust and quality assurance level
    display_name: Verified
    synonyms:
      - verification
      - verified status
      - host verified
  
  - name: rating
    expr: source.rating
    comment: Host quality rating for performance and satisfaction tracking
    display_name: Host Rating
    synonyms:
      - rating
      - host score
      - quality rating
  
  - name: country
    expr: source.country
    comment: Host country location for geographic distribution analysis
    display_name: Country
    synonyms:
      - host country
      - location
      - nation
  
  - name: is_active
    expr: source.is_active
    comment: Host active status for retention and churn analysis
    display_name: Active
    synonyms:
      - active
      - status
      - host status
  
  - name: joined_at
    expr: source.joined_at
    comment: Host account creation date for cohort and tenure analysis
    display_name: Joined Date
    synonyms:
      - signup date
      - join date
      - registration date
      - created date
  
  - name: host_since_days
    expr: DATEDIFF(CURRENT_DATE(), source.joined_at)
    comment: Number of days since host joined platform for tenure analysis
    display_name: Days as Host
    synonyms:
      - tenure
      - days active
      - time on platform

measures:
  - name: host_count
    expr: COUNT(DISTINCT source.host_id)
    comment: >
      Total number of unique hosts. Partner network size metric showing
      supply-side scale and market coverage.
    display_name: Host Count
    format:
      type: number
      decimal_places:
        type: all
      abbreviation: compact
    synonyms:
      - hosts
      - owners
      - partners
      - host network
  
  - name: verified_count
    expr: SUM(CASE WHEN source.is_verified = true THEN 1 ELSE 0 END)
    comment: >
      Number of verified hosts. Quality metric showing trustworthy partner
      base size for platform credibility analysis.
    display_name: Verified Hosts
    format:
      type: number
      decimal_places:
        type: all
      abbreviation: compact
    synonyms:
      - verified
      - verified partners
      - trusted hosts
  
  - name: avg_rating
    expr: AVG(source.rating)
    comment: >
      Average host quality rating. Quality benchmark showing overall partner
      satisfaction and performance levels.
    display_name: Avg Host Rating
    format:
      type: number
      decimal_places:
        type: exact
        places: 2
    synonyms:
      - average rating
      - typical rating
      - host score
  
  - name: property_count
    expr: COUNT(DISTINCT dim_property.property_id)
    comment: >
      Total number of properties managed by hosts. Portfolio size metric
      showing host investment and platform inventory depth.
    display_name: Property Count
    format:
      type: number
      decimal_places:
        type: all
      abbreviation: compact
    synonyms:
      - properties
      - listings
      - inventory
      - properties per host
  
  - name: total_revenue
    expr: SUM(fact_booking.total_amount)
    comment: >
      Total revenue generated by hosts. Primary financial metric for host
      earnings and platform transaction volume analysis.
    display_name: Total Revenue
    format:
      type: currency
      currency_code: USD
      decimal_places:
        type: exact
        places: 2
      abbreviation: compact
    synonyms:
      - revenue
      - earnings
      - income
      - host revenue
  
  - name: booking_count
    expr: COUNT(fact_booking.booking_id)
    comment: >
      Total number of bookings received by hosts. Volume metric showing
      host success and property demand patterns.
    display_name: Booking Count
    format:
      type: number
      decimal_places:
        type: all
      abbreviation: compact
    synonyms:
      - bookings
      - reservations
      - orders
      - host bookings
  
  - name: revenue_per_host
    expr: SUM(fact_booking.total_amount) / NULLIF(COUNT(DISTINCT source.host_id), 0)
    comment: >
      Average revenue per host. Efficiency metric showing typical host
      earnings for partner value analysis and incentive design.
    display_name: Revenue per Host
    format:
      type: currency
      currency_code: USD
      decimal_places:
        type: exact
        places: 2
    synonyms:
      - avg revenue
      - average earnings
      - host performance
  
  - name: verification_rate
    expr: (SUM(CASE WHEN source.is_verified = true THEN 1 ELSE 0 END) / NULLIF(COUNT(DISTINCT source.host_id), 0)) * 100
    comment: >
      Percentage of hosts that are verified. Quality indicator showing
      platform trustworthiness and verification program effectiveness.
    display_name: Verification Rate
    format:
      type: percentage
      decimal_places:
        type: exact
        places: 1
    synonyms:
      - verified percentage
      - verification percent
      - trust rate

